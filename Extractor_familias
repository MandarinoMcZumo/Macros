Sub Extraer_familias()

Dim office As Range, value_seeker As Range
Dim office_name As String
Dim looper As Integer



Application.ScreenUpdating = False

    Dim xWs As Worksheet
    Application.DisplayAlerts = False
    For Each xWs In Application.ActiveWorkbook.Worksheets
        If xWs.Name <> "SARG2" Then
            xWs.Delete
        End If
    Next
    Application.DisplayAlerts = True


For Each office In Range("D1:DS1")

    office_name = office

    Sheets.Add.Name = office_name

        With Range("A1")
            .Value = "Ofreceré..."
            .Interior.Color = RGB(155, 187, 89)
            .Font.Color = vbWhite
            .Font.Bold = True
        End With
        
        With Range("B1")
            .Value = "siempre que la suma de estos sea..."
            .Interior.Color = RGB(155, 187, 89)
            .Font.Color = vbWhite
            .Font.Bold = True
        End With
        
        With Range("C1")
            .Value = "Periodo"
            .Interior.Color = RGB(155, 187, 89)
            .Font.Color = vbWhite
            .Font.Bold = True
        End With
            
        With Range("D1")
            .Value = "Parámetro"
            .Interior.Color = RGB(155, 187, 89)
            .Font.Color = vbWhite
            .Font.Bold = True
        End With
            
            
    Worksheets("SARG2").Activate

    For Each value_seeker In Range(Cells(3, office.Column), Cells(200, office.Column))
        
           If IsEmpty(value_seeker) = False Then
            
                               
                With Worksheets(office_name).Cells(2 + looper, 1)
                    .Value = Worksheets("SARG2").Cells(value_seeker.Row, 1).Value
                    .Interior.Color = RGB(235, 241, 221)
                    .Font.Bold = True
                
                End With
                
                
                With Worksheets(office_name).Cells(2 + looper, 2)
                    .Value = Worksheets("SARG2").Cells(value_seeker.Row, 2).Value
                    .Interior.Color = RGB(235, 241, 221)
                    .Font.Bold = True
                
                End With
                
                
                With Worksheets(office_name).Cells(2 + looper, 3)
                    .Value = Worksheets("SARG2").Cells(value_seeker.Row, 3).Value
                    .Interior.Color = RGB(235, 241, 221)
                    
                    
                End With
                
                With Worksheets(office_name).Cells(2 + looper, 4)
                    .Value = value_seeker.Value
                    .Interior.Color = RGB(235, 241, 221)
                    
                    
                End With
            
            looper = looper + 1
            
           End If
        Worksheets(office_name).Columns("A:E").AutoFit
    Next value_seeker

   
   looper = 0

Next office
       
Dim xSh As Worksheet
  
    For Each xSh In Worksheets
    
    If xSh.Name <> "SARG2" Then
    
        xSh.Select
        Call conversor_parametros
        
    End If
        
Next
   

Worksheets("SARG2").Activate
      
       
Application.ScreenUpdating = True

  
End Sub

Private Sub conversor_parametros()

On Error Resume Next

  Dim ofrecidos() As String, cubiertos() As String
  Dim mycell As Range
  Dim vuelta As Integer, vuelta2 As Integer, num As Integer, stock_seguridad As String
  Dim repeater As Integer, cuenta As Integer, cuenta2 As Integer
Range("F2:J50").Clear

With Range("f1")
    .Value = "Ofrecidos"
    .Interior.Color = vbBlue
    .Font.Color = vbWhite
    .Font.Bold = True
End With

With Range("g1")
    .Value = "Cubiertos"
    .Interior.Color = vbBlue
    .Font.Color = vbWhite
    .Font.Bold = True
End With

With Range("H1")
    .Value = "Parámetro"
    .Interior.Color = vbBlue
    .Font.Color = vbWhite
    .Font.Bold = True
End With


For Each mycell In Range("A2:A30")
  
  If IsEmpty(mycell) = False Then
        ofrecidos = Split(mycell.Value, " ")    'Selecciono una celda con información
        cubiertos = Split(mycell.Offset(0, 1), " ")
        stock_seguridad = mycell.Offset(0, 3)
                
        num = 0

        Do Until num > UBound(ofrecidos)                'bucle de los grupos ofrecidos
            
            
                        
            Do Until cuenta = UBound(cubiertos) + 1
            
            Cells(2 + vuelta2, 6).Value = ofrecidos(num)
            Cells(2 + vuelta2, 8).Value = stock_seguridad
            vuelta2 = vuelta2 + 1
            cuenta = cuenta + 1
                
            Debug.Print "primer bucle"
            
            Loop
            
            num = num + 1
            cuenta = 0
        
        
        Loop
      
        cuenta2 = 0
        

        Do Until cuenta2 = UBound(ofrecidos) + 1            'bucle de los grupos cubiertos

            Cells(2 + vuelta, 7).Resize(UBound(cubiertos) + 1) = Application.Transpose(cubiertos)

            vuelta = UBound(cubiertos) + vuelta + 1

            cuenta2 = cuenta2 + 1

        Loop
    
    
    
    
    End If
    
Next mycell



End Sub
