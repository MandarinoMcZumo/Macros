
Sub Calculador()

Dim stock_grupo As Integer, celda As Range

stock_grupo = InputBox("Por favor, introduce el stock de seguridad para este grupo", "Stock de seguridad")

Application.ScreenUpdating = False


Range(ActiveCell, ActiveCell.Offset(0, 60)).Select

For Each celda In Selection

celda.FormulaR1C1 = "=IF((MIN(R[-1]C:R[-1]C[4])-" & stock_grupo & ")<=0,""NO"",MIN(R[-1]C:R[-1]C[4])-" & stock_grupo & ")"

Next celda



Application.ScreenUpdating = True


End Sub

Sub Resaltador_NO()
'
' Resaltador_NO Macro
'

'
Application.ScreenUpdating = False

    Range("D3").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="NO", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16383844
        .TintAndShade = 0
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13551615
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("D3").Select
Application.ScreenUpdating = True

    
End Sub
